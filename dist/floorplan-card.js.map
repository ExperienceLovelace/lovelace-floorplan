{"version":3,"file":"floorplan-card.js","sources":["../src/floorplan-card.js"],"sourcesContent":["global.$ = require(\"jquery\");\nvar YAML = require(\"yamljs\");\n\n// jQuery LongPress Plugin\nrequire(\"jquery.longpress\");\n\n// Main Floorplan lib\nrequire(\"floorplan\");\n\nclass FloorplanCard extends HTMLElement {\n  constructor() {\n    super();\n\n    this.version = \"1.1.8\";\n\n    this.isScriptsLoading = false;\n    this.isFloorplanLoading = false;\n\n    this.isFloorplanLoaded = false;\n\n    this.attachShadow({ mode: \"open\" });\n  }\n\n  setConfig(config) {\n    this.config = JSON.parse(JSON.stringify(config));\n\n    this.initCard(config);\n    this.setIsLoading(true);\n  }\n\n  set hass(hass) {\n    if (!this.config || this.isScriptsLoading || this.isFloorplanLoading)\n      return;\n\n    (this.isFloorplanLoaded\n      ? Promise.resolve()\n      : this.loadFloorplan(hass, this.config)\n    ).then(() => {\n      this.floorplan.hassChanged(hass);\n    });\n  }\n\n  loadFloorplan(hass, config) {\n    this.isFloorplanLoading = true;\n\n    const floorplan = new Floorplan();\n\n    const options = {\n      root: this.shadowRoot,\n      hass: hass,\n      openMoreInfo: this.openMoreInfo.bind(this),\n      setIsLoading: this.setIsLoading.bind(this),\n      config: (config && config.config) || config,\n    };\n\n    return floorplan.init(options).then(() => {\n      this.setIsLoading(false);\n      this.floorplan = floorplan;\n      this.isFloorplanLoading = false;\n      this.isFloorplanLoaded = true;\n    });\n  }\n\n  initCard(config) {\n    const root = this.shadowRoot;\n    if (root.lastChild) root.removeChild(root.lastChild);\n\n    const style = document.createElement(\"style\");\n    style.textContent = this.getStyle();\n    root.appendChild(style);\n\n    const card = document.createElement(\"ha-card\");\n    card.header = config.title;\n    root.appendChild(card);\n\n    const container = document.createElement(\"div\");\n    container.id = \"container\";\n    card.appendChild(container);\n\n    const spinner = document.createElement(\"paper-spinner-lite\");\n    container.appendChild(spinner);\n\n    const floorplan = document.createElement(\"div\");\n    floorplan.id = \"floorplan\";\n    container.appendChild(floorplan);\n\n    const log = document.createElement(\"div\");\n    log.id = \"log\";\n    container.appendChild(log);\n\n    const link = document.createElement(\"a\");\n    link.setAttribute(\"href\", \"#\");\n    link.text = \"Clear log\";\n    log.appendChild(link);\n    link.onclick = function () {\n      $(this).siblings(\"ul\").html(\"\").parent().css(\"display\", \"none\");\n    };\n\n    const list = document.createElement(\"ul\");\n    log.appendChild(list);\n\n    this.log = log;\n    this.spinner = spinner;\n  }\n\n  getStyle() {\n    return `\n      #container {\n        text-align: center;\n      }\n\n      paper-spinner-lite {\n        margin-bottom: 50px;\n      }\n\n      #log {\n        max-height: 150px;\n        overflow: auto;\n        background-color: #eee;\n        display: none;\n        padding: 10px;\n      }\n\n      #log ul {\n        list-style-type: none;\n        padding-left: 0px;\n        text-align: left;\n      }\n\n      .error {\n        color: #FF0000;\n      }\n\n      .warning {\n        color: #FF851B;\n      }\n\n      .info {\n        color: #0000FF;\n      }\n\n      .debug {\n        color: #000000;\n      }\n    `;\n  }\n\n  openMoreInfo(entityId) {\n    this.fire(\"hass-more-info\", { entityId: entityId });\n  }\n\n  setIsLoading(isLoading) {\n    this.isLoading = isLoading;\n\n    if (this.isLoading) {\n      this.spinner.setAttribute(\"active\", \"\");\n      this.spinner.style.display = \"inline-block\";\n    } else {\n      this.spinner.removeAttribute(\"active\");\n      this.spinner.style.display = \"none\";\n    }\n  }\n\n  logError(message) {\n    console.error(message);\n\n    $(this.log).find(\"ul\").prepend(`<li class=\"error\">${message}</li>`);\n    $(this.log).css(\"display\", \"block\");\n  }\n\n  fire(type, detail, options) {\n    options = options || {};\n    detail = detail === null || detail === undefined ? {} : detail;\n    const event = new Event(type, {\n      bubbles: options.bubbles === undefined ? true : options.bubbles,\n      cancelable: Boolean(options.cancelable),\n      composed: options.composed === undefined ? true : options.composed,\n    });\n    event.detail = detail;\n    const node = options.node || this;\n    node.dispatchEvent(event);\n    return event;\n  }\n\n  loadScript(scriptUrl, useCache) {\n    return new Promise((resolve, reject) => {\n      const script = document.createElement(\"script\");\n      script.async = true;\n      script.src = useCache ? scriptUrl : this.cacheBuster(scriptUrl);\n      script.onload = () => resolve();\n      script.onerror = (err) => reject(new URIError(`${err.target.src}`));\n      this.appendChild(script);\n    });\n  }\n\n  cacheBuster(url) {\n    return `${url}${\n      url.indexOf(\"?\") >= 0 ? \"&\" : \"?\"\n    }_=${new Date().getTime()}`;\n  }\n}\n\ncustomElements.define(\"floorplan-card\", FloorplanCard);\n"],"names":[],"mappings":"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"}